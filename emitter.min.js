(function(c){var d=function(i,h,j,f,g){var e=function(){if(g){i.off(h,j)}return j.apply(f,arguments)};e.callback=j;return e};var b=function(e){return e.length===1?[e[0]]:Array.apply(null,e)};function a(){var f={};function e(){}e.prototype.on=function(i,j,g,h){if(!f[i]){f[i]=[]}f[i].push(d(this,i,j,g,h));return this};e.prototype.off=function(k,l){var g=[],h=0,j,i;if(!l){return delete (f[k])}i=this.listeners(k);j=i.length;for(;h<j;h++){if(l===i[h].callback){continue}g.push(i[h])}if(g.length===0){return delete (f[k])}else{f[k]=g}};e.prototype.listeners=function(g){return(f[g]||[]).slice(0)};e.prototype.once=function(h,i,g){this.on(h,i,g,true)};e.prototype.emit=function(){var g=b(arguments),i=g.shift(),h=this.listeners(i),j;while(h.length){j=h.shift();j.apply(undefined,g)}};return new e()}c.create=a;c.extend=function(g,e){var f=this.create();g[e||"_emitter"]=f;g.on=f.on.bind(f);g.off=f.off.bind(f);g.once=f.once.bind(f);g.emit=f.emit.bind(f);g.listeners=f.listeners.bind(f)}})(typeof(exports)==="undefined"?this.Emitter={}:exports);